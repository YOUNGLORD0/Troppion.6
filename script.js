(function () {
  window.DETAILS = {
    1: {
      title:
        "Piala Logam Champions Upper x Lower Harmonika Internal Badminton Cup",
      desc: `<p>Di kejuaraan internal yang sarat sorak dan energi positif, para pemain menampilkan konsistensi dan resiliensi—nilai yang lekat dengan ekosistem <a href="https://troppion.com/piala-event/piala-olahraga/" target="_blank" rel="noopener" class="highlight-link">Piala Olahraga</a>. Setiap gim adalah panggung pembuktian karakter, bukan sekadar angka di papan skor.</p>
<p>Piala logam Champions Upper mengusung geometri modern dengan ukiran presisi dan finishing rapi—silhouette yang gagah untuk seremoni <a href="https://troppion.com/piala-event/piala-olahraga/piala-bulutangkis/" target="_blank" rel="noopener" class="highlight-link">Piala Bulutangkis</a>. Bobotnya mantap, tampilannya mewah, dan siap menjadi ikon podium.</p>
<p>Abadikan detik kemenangan dan kembangkan identitas turnamen Anda bersama <a href="https://troppion.com/" target="_blank" rel="noopener" class="highlight-link">Troppion</a>—dari sketsa konsep hingga trofi siap diangkat di atas kepala juara.</p>`,
    },

    2: {
      title:
        "Piala Winner Sinergi Tepok Bulu 2025 FT Waingapu Sport PT Pertamina",
      desc: `<p>Gelaran korporat yang hangat ini menyatukan semangat kolaborasi dan kompetisi dalam standar mutu <a href="https://troppion.com/piala-event/piala-olahraga/" target="_blank" rel="noopener" class="highlight-link">Piala Olahraga</a>. Sinergi antartim terasa di setiap reli—solid, cepat, dan saling menguatkan.</p>
<p>Trofi pemenang dirancang dengan aksen shuttlecock dan bintang, merepresentasikan presisi dan progres, ideal untuk pilar prestasi di ajang <a href="https://troppion.com/piala-event/piala-olahraga/piala-bulutangkis/" target="_blank" rel="noopener" class="highlight-link">Piala Bulutangkis</a>. Lapisan metalik memberi kilau premium yang memikat sorot kamera.</p>
<p>Naikkan gengsi seremoni penghargaan Anda dengan kreasi eksklusif dari <a href="https://troppion.com/" target="_blank" rel="noopener" class="highlight-link">Troppion</a>—personal, rapi, dan tepat waktu.</p>`,
    },

    3: {
      title: "Piala Logam Juara Umum Bulu Tangkis Pupuk Kaltim Open 2024",
      desc: `<p>Panggung kompetisi ini mengkurasi duel terbaik, menonjolkan disiplin dan keberanian—jiwa sport yang dirayakan dalam ranah <a href="https://troppion.com/piala-event/piala-olahraga/" target="_blank" rel="noopener" class="highlight-link">Piala Olahraga</a>. Atmosfernya intens, namun tetap menjunjung fair play.</p>
<p>Piala juara umum tampil dominan dengan nuansa emas, profil tegas, serta detail elegan—bahasa visual yang pas untuk mahkota kemenangan kategori <a href="https://troppion.com/piala-event/piala-olahraga/piala-bulutangkis/" target="_blank" rel="noopener" class="highlight-link">Piala Bulutangkis</a>. Material premium memastikan daya tahan dan prestise yang bertahan lama.</p>
<p>Rancang penghargaan yang sepadan dengan reputasi turnamen Anda bersama <a href="https://troppion.com/" target="_blank" rel="noopener" class="highlight-link">Troppion</a>—diolah teliti, dieksekusi profesional.</p>`,
    },

    4: {
      title: "Piala Bergilir Bulu Tangkis Cluster 89 Bekasi",
      desc: `<p>Kompetisi komunitas ini menyulam kedekatan dan sportivitas, menghadirkan tontonan berkualitas ala standar <a href="https://troppion.com/piala-event/piala-olahraga/" target="_blank" rel="noopener" class="highlight-link">Piala Olahraga</a>. Tradisi piala bergilir menjadi pengikat cerita dari musim ke musim.</p>
<p>Desain trofi menggabungkan logam berkilau dan base yang stabil, dihiasi detail bintang—ikon prestise untuk siklus juara pada ajang <a href="https://troppion.com/piala-event/piala-olahraga/piala-bulutangkis/" target="_blank" rel="noopener" class="highlight-link">Piala Bulutangkis</a>. Tampak elegan ketika dipajang, berkelas saat diserahkan.</p>
<p>Teguhkan warisan kompetisi Anda dengan piala bergilir yang dirancang khusus di <a href="https://troppion.com/" target="_blank" rel="noopener" class="highlight-link">Troppion</a>—tersedia opsi material dan finishing yang fleksibel.</p>`,
    },

    5: {
      title:
        "Piala Bulu Tangkis Juara Umum Resin Logam Badminton Bayan Open 400 Jakarta",
      desc: `<p>Event bergengsi ini memompa adrenalin dan memantik performa terbaik, sesuai standar selebrasi dalam ekosistem <a href="https://troppion.com/piala-event/piala-olahraga/" target="_blank" rel="noopener" class="highlight-link">Piala Olahraga</a>. Setiap set menampilkan taktik, ritme, dan keberanian mengambil risiko.</p>
<p>Trofi juara umum memadukan resin dan logam untuk menghadirkan siluet modern yang berbeda dari kebanyakan—hadiah yang pantas untuk pemenang utama di panggung <a href="https://troppion.com/piala-event/piala-olahraga/piala-bulutangkis/" target="_blank" rel="noopener" class="highlight-link">Piala Bulutangkis</a>. Detailnya rapi, kesan visualnya kuat.</p>
<p>Wujudkan trofi yang menonjolkan karakter turnamen Anda, dikerjakan ahli oleh <a href="https://troppion.com/" target="_blank" rel="noopener" class="highlight-link">Troppion</a>—custom tanpa ribet.</p>`,
    },

    6: {
      title: "Piala Bergilir Badminton PT Multi Harapan Utama",
      desc: `<p>Sinergi kerja tumbuh lewat kompetisi sehat yang dikelola profesional, menghadirkan pengalaman tanding khas standar <a href="https://troppion.com/piala-event/piala-olahraga/" target="_blank" rel="noopener" class="highlight-link">Piala Olahraga</a>. Momentum kemenangan menjadi pemantik moral seluruh tim.</p>
<p>Piala bergilir berbahan resin premium tampil berwibawa, dengan komposisi bentuk yang dinamis—citra yang selaras untuk ajang korporat kategori <a href="https://troppion.com/piala-event/piala-olahraga/piala-bulutangkis/" target="_blank" rel="noopener" class="highlight-link">Piala Bulutangkis</a>. Kokoh dipegang, memikat saat difoto.</p>
<p>Bicarakan ide desain dan personalisasi engraving Anda bersama <a href="https://troppion.com/" target="_blank" rel="noopener" class="highlight-link">Troppion</a>—kami atur hingga detail terakhir.</p>`,
    },

    7: {
      title: "Piala Bulu Tangkis Juara 1 Riung Priangan Badminton Cup 2024",
      desc: `<p>Festival kompetisi ini menyajikan duel teknis yang menghibur, merekam determinasi atlet dalam konteks selebrasi <a href="https://troppion.com/piala-event/piala-olahraga/" target="_blank" rel="noopener" class="highlight-link">Piala Olahraga</a>. Riuh penonton menambah tensi dan rasa bangga lokal.</p>
<p>Piala Juara 1 berbahan resin dengan proporsi harmonis dan aksen tegas—format podium yang ideal untuk perayaan kategori <a href="https://troppion.com/piala-event/piala-olahraga/piala-bulutangkis/" target="_blank" rel="noopener" class="highlight-link">Piala Bulutangkis</a>. Mengkilap di podium, impresif di dokumentasi.</p>
<p>Jadikan seremoni penyerahan trofi Anda lebih berkesan dengan paket custom dari <a href="https://troppion.com/" target="_blank" rel="noopener" class="highlight-link">Troppion</a>—kualitas tinggi tanpa kompromi.</p>`,
    },

    8: {
      title: "Piala Bulu Tangkis Riung Priangan Badminton Cup 2024",
      desc: `<p>Garis-garis permainan berpadu dengan sorot lampu dan sorak komunitas, menciptakan pengalaman tanding yang hangat—persis semangat yang dijunjung dalam spektrum <a href="https://troppion.com/piala-event/piala-olahraga/" target="_blank" rel="noopener" class="highlight-link">Piala Olahraga</a>. Kompetisi terasa akrab sekaligus menantang.</p>
<p>Trophy kombinasi akrilik–resin menyajikan estetika bersih dengan detail tematik—identitas visual yang pas untuk panggung <a href="https://troppion.com/piala-event/piala-olahraga/piala-bulutangkis/" target="_blank" rel="noopener" class="highlight-link">Piala Bulutangkis</a>. Ringan, kuat, dan mudah dipersonalisasi.</p>
<p>Konsultasikan konsep dan moodboard Anda, lalu biarkan <a href="https://troppion.com/" target="_blank" rel="noopener" class="highlight-link">Troppion</a> menerjemahkannya jadi trofi yang berbicara.</p>`,
    },

    9: {
      title:
        "Piala Badminton Mustika Sembuluh Group 2024 Juara Ganda Putra Beregu PT Wilmar Kalimantan",
      desc: `<p>Ajang internal ini mengasah koordinasi dan kepercayaan—dua pilar penting yang sering lahir dari budaya tanding sehat ala <a href="https://troppion.com/piala-event/piala-olahraga/" target="_blank" rel="noopener" class="highlight-link">Piala Olahraga</a>. Kemenangan tim menjadi kebanggaan kolektif.</p>
<p>Piala akrilik berwajah modern menonjolkan kejernihan material dan layering tipis—tampilan kontemporer yang serasi untuk seremoni <a href="https://troppion.com/piala-event/piala-olahraga/piala-bulutangkis/" target="_blank" rel="noopener" class="highlight-link">Piala Bulutangkis</a>. Elegan dipajang, nyaman digenggam.</p>
<p>Perkuat momen apresiasi Anda lewat desain khusus yang ditangani tim produksi <a href="https://troppion.com/" target="_blank" rel="noopener" class="highlight-link">Troppion</a>—akurasi ukuran, warna, hingga plat nama.</p>`,
    },

    10: {
      title: "Piala Turnamen Bulutangkis Beregu Putra – HUT ke-50 KORPRI",
      desc: `<p>Merayakan lima dekade pengabdian, kompetisi beregu ini memadukan formalitas perayaan dan keceriaan panggung olahraga—selaras dengan nilai luhur di ekosistem <a href="https://troppion.com/piala-event/piala-olahraga/" target="_blank" rel="noopener" class="highlight-link">Piala Olahraga</a>. Seremoni terasa khidmat namun tetap meriah.</p>
<p>Piala beregu putra mengusung simbolisme yang kuat, detail halus, dan material berkelas—penanda prestasi yang layak untuk momen bersejarah kategori <a href="https://troppion.com/piala-event/piala-olahraga/piala-bulutangkis/" target="_blank" rel="noopener" class="highlight-link">Piala Bulutangkis</a>. Tampil menawan di panggung penghormatan.</p>
<p>Rayakan tonggak perayaan dengan trofi yang dirancang saksama oleh <a href="https://troppion.com/" target="_blank" rel="noopener" class="highlight-link">Troppion</a>—cerita 50 tahun yang dirangkum dalam satu karya.</p>`,
    },

    11: {
      title: "Piala Juara Umum Bulutangkis Bupati Cup Kutai Timur",
      desc: `<p>Kompetisi kebanggaan daerah ini menjadi ajang unjuk kualitas sekaligus silaturahmi, selaras dengan marwah selebrasi di payung <a href="https://troppion.com/piala-event/piala-olahraga/" target="_blank" rel="noopener" class="highlight-link">Piala Olahraga</a>. Sorotan publik mengiringi tiap penentuan gim.</p>
<p>Piala Juara Umum menyatukan desain khas dan material kokoh, menghadirkan pusat perhatian yang pantas untuk gelar tertinggi pada ajang <a href="https://troppion.com/piala-event/piala-olahraga/piala-bulutangkis/" target="_blank" rel="noopener" class="highlight-link">Piala Bulutangkis</a>. Proporsinya selaras, klaim prestisenya jelas.</p>
<p>Siapkan seremoni puncak yang tak terlupakan—kemas dengan piala custom dari <a href="https://troppion.com/" target="_blank" rel="noopener" class="highlight-link">Troppion</a> yang merefleksikan identitas daerah Anda.</p>`,
    },

    12: {
      title: "Piala Juara 1 SIG Sudirman Cup Badminton",
      desc: `<p>Turnamen sarat gengsi ini menguji fokus, taktik, dan ketahanan tim, memantulkan semangat yang diusung kompetisi pada ranah <a href="https://troppion.com/piala-event/piala-olahraga/" target="_blank" rel="noopener" class="highlight-link">Piala Olahraga</a>. Atmosfernya kompetitif namun sportif.</p>
<p>Piala Juara 1 bergaya elegan, tegas pada garis, dan apik pada detail—ikon visual yang pas untuk klimaks seremoni kategori <a href="https://troppion.com/piala-event/piala-olahraga/piala-bulutangkis/" target="_blank" rel="noopener" class="highlight-link">Piala Bulutangkis</a>. Setara dengan reputasi para kampiun.</p>
<p>Tingkatkan standar penghargaan Anda—pilih opsi kustomisasi yang luas bersama <a href="https://troppion.com/" target="_blank" rel="noopener" class="highlight-link">Troppion</a>, dari finishing hingga kemasan.</p>`,
    },

    13: {
      title:
        "Piala Juara 1 Turnamen Bulutangkis Ganda Dewasa – Walikota Cup Lubuk Linggau",
      desc: `<p>Turnamen ganda dewasa ini menuntut komunikasi, kecepatan, dan keberanian mengambil keputusan—nilai yang dirayakan dalam tradisi kompetisi di bawah payung <a href="https://troppion.com/piala-event/piala-olahraga/" target="_blank" rel="noopener" class="highlight-link">Piala Olahraga</a>. Tiap reli adalah simfoni sinkronisasi.</p>
<p>Trofi juara dirancang simbolis dengan material unggulan, menegaskan momen puncak yang layak dikenang pada skena <a href="https://troppion.com/piala-event/piala-olahraga/piala-bulutangkis/" target="_blank" rel="noopener" class="highlight-link">Piala Bulutangkis</a>. Elegan saat diserahkan, impresif saat dipajang.</p>
<p>Buktikan kelas ajang Anda dengan penghargaan yang berbicara banyak—dirancang rapi oleh <a href="https://troppion.com/" target="_blank" rel="noopener" class="highlight-link">Troppion</a> khusus untuk kebutuhan Anda.</p>`,
    },
  };
  /* ===================== 2) GAMBAR BERURUTAN ===================== */
  const IMG_SEQ_CONFIG = {
    basePath: "assets/images",
    prefix: "badminton",
    start: 1,
    total: 27,
    ext: "jpg", // default: mayoritas file kamu .jpg
    exts: ["webp", "jpg", "jpeg", "png", "gif"], // urutan fallback
  };

  // yang .webp: 1–3
  const EXT_BY_INDEX = { 144: "webp", 24: "webp", 34: "webp" };

  function urlForImage(idx, cfg = IMG_SEQ_CONFIG, extOverride) {
    const chosenExt = extOverride || EXT_BY_INDEX[idx] || cfg.ext;
    return `${cfg.basePath}/${cfg.prefix}${idx}.${chosenExt}`;
  }

  /** set <img> dengan fallback ke daftar ekstensi */
  function setImageWithFallback(imgEl, idx, cfg = IMG_SEQ_CONFIG) {
    // mulai dari ext khusus (kalau ada), lalu coba sisa exts
    const firstExt = EXT_BY_INDEX[idx] || cfg.ext;
    const queue = [firstExt, ...cfg.exts.filter((e) => e !== firstExt)];
    let i = 0;

    function tryLoad() {
      imgEl.src = urlForImage(idx, cfg, queue[i]);
    }
    imgEl.onerror = () => {
      i++;
      if (i < queue.length) tryLoad();
      else {
        imgEl.onerror = null;
        imgEl.src =
          "https://images.unsplash.com/photo-1519681393600-7e08d64b9dc3?q=80&w=1200&auto=format&fit=crop";
      }
    };
    tryLoad();
  }

  function assignSequentialImages(cfg = IMG_SEQ_CONFIG) {
    const cards = Array.from(document.querySelectorAll(".product-card"));
    let idx = cfg.start;
    for (let i = 0; i < cards.length; i++) {
      if (idx > cfg.start - 1 + cfg.total) break;
      const card = cards[i];
      const btn = card.querySelector("[data-open-detail]");
      if (!btn) continue;

      const hasImg = (btn.getAttribute("data-img") || "").trim().length > 0;
      if (!hasImg) {
        const url = urlForImage(idx, cfg);
        btn.setAttribute("data-img", url);
        const thumb = card.querySelector(".product-thumb");
        if (thumb) thumb.src = url;
        idx++;
      }
    }
  }

  /* ===================== 3) UTIL ===================== */
  const DEFAULT_IMG =
    "https://images.unsplash.com/photo-1519681393600-7e08d64b9dc3?q=80&w=1200&auto=format&fit=crop";

  const slugify = (s = "") =>
    s
      .toString()
      .toLowerCase()
      .normalize("NFD")
      .replace(/[\u0300-\u036f]/g, "")
      .replace(/[^a-z0-9]+/g, "-")
      .replace(/(^-|-$)+/g, "");

  const escapeHtml = (str = "") =>
    str.replace(
      /[&<>"']/g,
      (m) =>
        ({
          "&": "&amp;",
          "<": "&lt;",
          ">": "&gt;",
          '"': "&quot;",
          "'": "&#039;",
        }[m])
    );

  /* ===================== 4) RENDER KARTU ===================== */
  function ensureCardThumbs() {
    const cards = document.querySelectorAll(".product-card");
    cards.forEach((card, idx) => {
      const btn = card.querySelector("[data-open-detail]");
      if (!btn) return;

      // Prioritas judul: DETAILS[data-id].title → data-title → H3 → "Produk X"
      const id = btn.dataset.id?.trim();
      const titleFromDetails = id && DETAILS[id]?.title;
      const dataTitle = btn.getAttribute("data-title")?.trim();
      const h3Existing = card.querySelector("h3")?.textContent?.trim();

      const title =
        titleFromDetails || dataTitle || h3Existing || `Produk ${idx + 1}`;

      const img = btn.getAttribute("data-img")?.trim() || DEFAULT_IMG;

      if (!card.id) card.id = `produk-${slugify(title)}`;

      const h3 = card.querySelector("h3");
      if (h3) {
        h3.textContent = title;
        h3.classList.add(
          "font-heading",
          "font-semibold",
          "text-lg",
          "product-title"
        );
      }

      if (!card.querySelector(".product-thumb")) {
        const wrap = card.querySelector(".reveal") || card;
        const imgEl = document.createElement("img");
        imgEl.className = "product-thumb w-full rounded-xl object-contain bg-white";
        imgEl.style.objectFit = "contain"; // pastikan pakai contain
        imgEl.style.borderRadius = "0"; // biar menempel ke pinggir
        imgEl.loading = "lazy";
        imgEl.src = img;
        imgEl.alt = title;
        wrap.prepend(imgEl);
      }
    });
  }

  /* ===================== 5) ANIMASI KARTU ===================== */
  const cards = Array.from(document.querySelectorAll(".product-card"));
  if (!("IntersectionObserver" in window) || cards.length === 0) {
    cards.forEach((c) => c.classList.add("in-view"));
  } else {
    const io = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const el = entry.target;
            const idx = cards.indexOf(el);
            el.style.transitionDelay = 80 * (idx % 8) + "ms";
            el.classList.add("in-view");
            io.unobserve(el);
          }
        });
      },
      { threshold: 0.2 }
    );
    cards.forEach((card) => io.observe(card));
  }

  /* ===================== 6) MODAL (Gambar Zoom + Judul + Deskripsi) ===================== */
  const modal = document.getElementById("detailModal");
  const titleEl = document.getElementById("detailTitle");
  const imgEl = document.getElementById("detailImg"); // akan dibungkus zoom-wrap
  const descEl = document.getElementById("detailDesc");
  const closeBtn = document.getElementById("closeModalBtn");

  // (opsional) Jika modal lama masih punya rating/keyword/kelebihan/kekurangan di HTML, hapus:
  (function removeExtraSections() {
    const ratingEl = document.getElementById("detailRating");
    if (ratingEl) {
      const grid = ratingEl.closest(".grid");
      if (grid) grid.remove();
    }
    const kwWrap = document.getElementById("detailKeywords")?.parentElement;
    if (kwWrap) kwWrap.remove();
  })();

  // Zoom state
  let zoom = { scale: 1, min: 1, max: 3, step: 0.25, panX: 0, panY: 0 };
  let zoomWrap;

  function wrapImageWithZoom() {
    if (!imgEl || imgEl.closest(".zoom-wrap")) return;
    zoomWrap = document.createElement("div");
    zoomWrap.className =
      "zoom-wrap relative overflow-hidden rounded-xl bg-gray-100";
    imgEl.parentNode.insertBefore(zoomWrap, imgEl);
    zoomWrap.appendChild(imgEl);

    const ctrls = document.createElement("div");
    ctrls.className = "zoom-controls absolute top-3 right-3 flex gap-2";
    ctrls.innerHTML = `
      <button type="button" class="zoom-btn rounded-md border px-2 py-1 bg-white" data-zoom="-">−</button>
      <button type="button" class="zoom-btn rounded-md border px-2 py-1 bg-white" data-zoom="+">+</button>
      <button type="button" class="zoom-btn rounded-md border px-2 py-1 bg-white" data-zoom="reset">Reset</button>
    `;
    zoomWrap.appendChild(ctrls);

    ctrls.addEventListener("click", (e) => {
      const z = e.target?.dataset?.zoom;
      if (z === "+") zoomIn();
      else if (z === "-") zoomOut();
      else if (z === "reset") resetZoom();
    });

    // Wheel-zoom
    zoomWrap.addEventListener(
      "wheel",
      (e) => {
        e.preventDefault();
        e.deltaY < 0 ? zoomIn() : zoomOut();
      },
      { passive: false }
    );

    // Double click reset
    imgEl.addEventListener("dblclick", resetZoom);

    // Drag-to-pan
    let isDown = false,
      startX = 0,
      startY = 0;
    zoomWrap.addEventListener("mousedown", (e) => {
      if (zoom.scale <= 1) return;
      isDown = true;
      zoomWrap.style.cursor = "grabbing";
      startX = e.clientX - zoom.panX;
      startY = e.clientY - zoom.panY;
    });
    window.addEventListener("mouseup", () => {
      isDown = false;
      zoomWrap.style.cursor = "";
    });
    zoomWrap.addEventListener("mousemove", (e) => {
      if (!isDown || zoom.scale <= 1) return;
      zoom.panX = e.clientX - startX;
      zoom.panY = e.clientY - startY;
      applyTransform();
    });
  }

  function applyTransform() {
    imgEl.style.transform = `translate(${zoom.panX}px, ${zoom.panY}px) scale(${zoom.scale})`;
    imgEl.style.transformOrigin = "center center";
    imgEl.style.transition = "transform 120ms ease";
  }
  function zoomIn() {
    zoom.scale = Math.min(zoom.max, zoom.scale + zoom.step);
    if (zoom.scale <= 1) zoom.panX = zoom.panY = 0;
    applyTransform();
  }
  function zoomOut() {
    zoom.scale = Math.max(zoom.min, zoom.scale - zoom.step);
    if (zoom.scale <= 1) zoom.panX = zoom.panY = 0;
    applyTransform();
  }
  function resetZoom() {
    zoom.scale = 1;
    zoom.panX = 0;
    zoom.panY = 0;
    applyTransform();
  }

  function openModal({ id, title, img, desc, cardId }) {
    // Jika ada ID & ditemukan di DETAILS, override title & desc dari sana
    if (id && DETAILS[id]) {
      title = DETAILS[id].title || title;
      desc = DETAILS[id].desc || desc;
    }

    titleEl.textContent = title || "";
    imgEl.src = img || DEFAULT_IMG;
    imgEl.alt = title || "Gambar produk";

    // Jika desc berasal dari DETAILS, itu HTML aman; kalau dari data-desc biasa → escape
    const isHtmlDesc = !!(id && DETAILS[id] && DETAILS[id].desc);
    const contentDesc = isHtmlDesc
      ? desc || ""
      : desc
      ? `<p>${escapeHtml(desc)}</p>`
      : "";

    const backlink = cardId
      ? `<br><br><a href="#${cardId}" class="detail-backlink text-brand underline font-semibold">Lihat produk di daftar</a>`
      : "";

    descEl.innerHTML = `${contentDesc}${backlink}`;

    resetZoom();
    modal.classList.remove("hidden");
    modal.setAttribute("aria-hidden", "false");
    document.body.style.overflow = "hidden";
  }

  function closeModal() {
    modal.classList.add("hidden");
    modal.setAttribute("aria-hidden", "true");
    document.body.style.overflow = "";
  }

  // Delegasi klik tombol "Detail"
  document.addEventListener("click", (e) => {
    const btn = e.target.closest("[data-open-detail]");
    if (!btn) return;
    const card = btn.closest(".product-card");
    const id = btn.dataset.id?.trim(); // <-- ambil ID untuk lookup DETAILS
    const dataTitle =
      btn.getAttribute("data-title") ||
      card.querySelector("h3")?.textContent ||
      "";
    const img = btn.getAttribute("data-img") || DEFAULT_IMG;
    const dataDesc = btn.getAttribute("data-desc") || "";
    openModal({ id, title: dataTitle, img, desc: dataDesc, cardId: card?.id });
  });

  // Close handlers
  closeBtn?.addEventListener("click", closeModal);
  modal?.addEventListener("click", (e) => {
    if (e.target === modal || e.target.classList.contains("bg-black/50"))
      closeModal();
  });
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && !modal.classList.contains("hidden")) closeModal();
  });

  // ====== INIT (urutan penting) ======
  assignSequentialImages(); // isi data-img otomatis: assets/images/golf1.jpg, dst.
  ensureCardThumbs(); // render thumbnail + judul pada kartu
  wrapImageWithZoom(); // aktifkan zoom di modal
})();
(function () {
  const cvs = document.getElementById("goldParticles");
  const ctx = cvs.getContext("2d");
  const wrap = document.getElementById("trophyWrap");
  const img = document.getElementById("trophyImg");
  const dpr = Math.max(1, Math.min(window.devicePixelRatio || 1, 2));

  let w = 0,
    h = 0,
    rect = null;
  let particles = [];
  let last = performance.now();

  // ====== PARAMETER TUNING ======
  const BASE_COUNT_DESKTOP = 110;
  const BASE_COUNT_MOBILE = 70;
  const GLOW_TRAIL = 0.22; // jejak (0=tidak ada, 1=hilang total)
  const MAX_DIST_FACTOR = 0.65; // seberapa jauh dari piala (0.4-0.8)
  const CENTER_PULL = 0.015; // tarikan ke pusat
  const WANDER = 0.35; // besaran gerak acak
  const SPEED = 32; // px/detik

  const isMobile = () => matchMedia("(max-width: 768px)").matches;

  function resizeCanvas() {
    rect = wrap.getBoundingClientRect();
    w = rect.width;
    h = rect.height;
    cvs.style.width = w + "px";
    cvs.style.height = h + "px";
    cvs.width = Math.floor(w * dpr);
    cvs.height = Math.floor(h * dpr);
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  }

  function getCenterAndRadius() {
    const i = img.getBoundingClientRect();
    const wr = wrap.getBoundingClientRect();
    const cx = (i.left + i.right) / 2 - wr.left;
    const cy = (i.top + i.bottom) / 2 - wr.top;
    // radius orbit dasar mengikuti ukuran piala
    const rx = i.width * MAX_DIST_FACTOR;
    const ry = i.height * MAX_DIST_FACTOR;
    return { cx, cy, rx, ry };
  }

  function spawnOne() {
    const { cx, cy, rx, ry } = getCenterAndRadius();
    // mulai di dekat elips piala
    const t = Math.random() * Math.PI * 2;
    const rj = 0.65 + Math.random() * 0.6; // variasi jarak
    const x = cx + Math.cos(t) * rx * rj;
    const y = cy + Math.sin(t) * ry * rj;

    const hue = 45 + Math.random() * 12;
    const size = 1.2 + Math.random() * 2.2;

    return {
      x,
      y,
      vx: (Math.random() - 0.5) * 10,
      vy: (Math.random() - 0.5) * 10,
      tw: Math.random() * Math.PI * 2, // fase kedip
      twSpeed: 2 + Math.random() * 3.5, // kecepatan kedip
      hue,
      sat: 90 + Math.random() * 10,
      light: 60 + Math.random() * 20,
      alpha: 0.65 + Math.random() * 0.35,
      size,
      sparkle: Math.random() < 0.18,
    };
  }

  function spawnAll() {
    particles = [];
    const count = isMobile() ? BASE_COUNT_MOBILE : BASE_COUNT_DESKTOP;
    for (let i = 0; i < count; i++) particles.push(spawnOne());
  }

  function step(dt) {
    const { cx, cy, rx, ry } = getCenterAndRadius();
    const maxR = Math.max(rx, ry) * 1.15;

    for (let i = particles.length - 1; i >= 0; i--) {
      const p = particles[i];

      // gerak acak (kunang-kunang): random walk + tarikan halus ke pusat
      p.vx += (Math.random() - 0.5) * WANDER;
      p.vy += (Math.random() - 0.5) * WANDER;

      p.vx += (cx - p.x) * CENTER_PULL * dt;
      p.vy += (cy - p.y) * CENTER_PULL * dt;

      // batasi kecepatan supaya lembut
      const maxV = SPEED;
      const vmag = Math.hypot(p.vx, p.vy);
      if (vmag > maxV) {
        p.vx = (p.vx / vmag) * maxV;
        p.vy = (p.vy / vmag) * maxV;
      }

      p.x += p.vx * dt;
      p.y += p.vy * dt;

      // jika terlalu jauh, teleport halus dekat orbit lagi
      const dist = Math.hypot(p.x - cx, p.y - cy);
      if (dist > maxR * 1.6) {
        const t = Math.random() * Math.PI * 2;
        p.x = cx + Math.cos(t) * maxR * 0.9;
        p.y = cy + Math.sin(t) * maxR * 0.9;
        p.vx *= 0.2;
        p.vy *= 0.2;
      }

      // update kedip
      p.tw += p.twSpeed * dt;
    }
  }

  function draw() {
    // fade agar ada trail lembut
    ctx.save();
    ctx.globalCompositeOperation = "destination-out";
    ctx.fillStyle = `rgba(0,0,0,${GLOW_TRAIL})`;
    ctx.fillRect(0, 0, w, h);
    ctx.restore();

    // gambar partikel
    particles.forEach((p) => {
      // flicker halus (0.75–1) + sparkle sesekali
      const flick = 0.75 + 0.25 * Math.sin(p.tw);
      const sparkleBoost = p.sparkle
        ? 0.25 + 0.75 * (Math.sin(p.tw * 3) * 0.5 + 0.5)
        : 0;
      const a = Math.min(1, p.alpha * flick + sparkleBoost * 0.25);

      // glow: lingkaran inti + halo
      ctx.globalCompositeOperation = "lighter";

      // halo
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.size * 3.2, 0, Math.PI * 2);
      ctx.fillStyle = `hsla(${p.hue}, ${p.sat}%, ${Math.min(
        90,
        p.light + 20
      )}%, ${a * 0.08})`;
      ctx.fill();

      // inti
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
      ctx.fillStyle = `hsla(${p.hue}, ${p.sat}%, ${p.light}%, ${a})`;
      ctx.fill();

      ctx.globalCompositeOperation = "source-over";
    });
  }

  function loop(now) {
    const dt = Math.min(0.05, (now - last) / 1000); // batas 50ms
    last = now;
    step(dt);
    draw();
    requestAnimationFrame(loop);
  }

  function start() {
    resizeCanvas();
    spawnAll();
    last = performance.now();
    requestAnimationFrame(loop);
  }

  window.addEventListener("resize", () => {
    resizeCanvas();
    // jaga jumlah partikel konsisten saat resize
    spawnAll();
  });

  if (img.complete) start();
  else img.addEventListener("load", start);
})();

// ====== PARALLAX RINGAN UNTUK BACKGROUND ======
(function () {
  const root = document.getElementById("bg-anim");
  if (!root) return;

  const blobs = root.querySelectorAll(".blob");
  const aurora = root.querySelector(".aurora");
  let ticking = false;

  function onScroll() {
    if (ticking) return;
    ticking = true;
    requestAnimationFrame(() => {
      const y = window.scrollY || 0;
      const f = Math.min(1, y / 1200); // batas pengaruh
      // gerakkan pelan ke bawah (parallax)
      aurora && (aurora.style.transform = `translate3d(0, ${f * 6}px, 0)`);
      blobs.forEach((b, i) => {
        const k = i % 2 ? 10 : 6; // variasi kedalaman
        b.style.transform = `translate3d(0, ${f * k}px, 0)`; // scale/rotate tetap dari keyframes
      });
      ticking = false;
    });
  }
  window.addEventListener("scroll", onScroll, { passive: true });
  onScroll(); // initial
})();
/* ===== MODAL DETAIL PRODUK (paste di akhir script.js) ===== */
(function () {
  // Kalau modal belum ada di DOM, jangan jalan
  const modal = document.getElementById('detailModal');
  if (!modal) return;

  // Nomor WA tujuan
  const WA_NUMBER = '6285728527934';

  // Elemen-elemennya
  const backdrop   = document.getElementById('modalBackdrop');
  const closeBtn   = document.getElementById('closeModalBtn');
  const closeBtn2  = document.getElementById('detailClose2');

  const titleEl    = document.getElementById('detailTitle');
  const nameEl     = document.getElementById('detailName');
  const priceEl    = document.getElementById('detailPrice');
  const imgEl      = document.getElementById('detailImg');
  const descEl     = document.getElementById('detailDesc');
  const orderBtn   = document.getElementById('detailOrderBtn');

  // DETAILS boleh sudah ada dari file ini juga; kalau belum, inisialisasi kosong
  window.DETAILS = window.DETAILS || {};
  const DEFAULT_IMG = 'https://images.unsplash.com/photo-1519681393600-7e08d64b9dc3?q=80&w=1200&auto=format&fit=crop';

  // Utils
  const escapeHtml = (s='') => s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m]));
  const buildWaLink = (name, price) => {
    const text = `Halo Troppion, saya ingin pesan ${name || 'produk ini'}${price ? ' ('+price+')' : ''}.`;
    return `https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(text)}`;
  };

function openModal(payload){
  const { id, dataTitle, img, dataDesc, cardId } = payload;

  // Cari dari DETAILS
  const fromDetails = (id && window.DETAILS && DETAILS[id]) ? DETAILS[id] : null;

  const title = (fromDetails?.title || dataTitle || '').trim();
  const descHTML = fromDetails?.desc
      ? fromDetails.desc // <-- ini HTML langsung dari DETAILS
      : (dataDesc ? `<p>${escapeHtml(dataDesc)}</p>` : '');

  titleEl.textContent = title || 'Detail Produk';
  nameEl.textContent  = title || '';
  priceEl.textContent = dataPrice || '';
  imgEl.src           = img || DEFAULT_IMG;
  imgEl.alt           = title || 'Gambar produk';

  // render deskripsi
  const backlink = cardId ? `<br><br><a href="#${cardId}" class="detail-backlink">Lihat produk di daftar</a>` : '';
  descEl.innerHTML = `${descHTML}${backlink}`;

  // link WA
  orderBtn.href = buildWaLink(title, dataPrice);

  modal.classList.remove('hidden');
  modal.setAttribute('aria-hidden','false');
  document.body.style.overflow = 'hidden';
}


  function closeModal(){
    modal.classList.add('hidden');
    modal.setAttribute('aria-hidden','true');
    document.body.style.overflow = '';
  }

  // Delegasi klik tombol “Detail”
  document.addEventListener('click', (e)=>{
    const btn = e.target.closest('[data-open-detail]');
    if(!btn) return;

    const card = btn.closest('.product-card');
    const payload = {
      id:        (btn.dataset.id || '').trim(),
      dataTitle: btn.getAttribute('data-title') || card?.querySelector('h3')?.textContent || '',
      dataPrice: btn.getAttribute('data-price') || '',
      img:       btn.getAttribute('data-img') || '',
      dataDesc:  btn.getAttribute('data-desc') || '',
      cardId:    card?.id || ''
    };
    openModal(payload);
  });

  // Tutup modal
  closeBtn?.addEventListener('click', closeModal);
  closeBtn2?.addEventListener('click', closeModal);
  backdrop?.addEventListener('click', closeModal);
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && !modal.classList.contains('hidden')) closeModal(); });
})();
